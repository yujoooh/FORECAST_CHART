<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, user-scalable=yes,  initial-scale=1">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>:: 해황예보도 이미지 자동생성 시스템 ::</title>

<link rel="stylesheet" href="inc/css/font.css" />
<link rel="stylesheet" href="inc/css/common.css" />

<script type="text/javascript" src="inc/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="inc/js/jquery-migrate-1.4.1.min.js"></script>
<script type="text/javascript" src="inc/js/jqueryRotate.js"></script>
<script type="text/javascript" src="inc/js/moment.js"></script>
<script type="text/javascript" src="inc/js/Chart.min.js"></script>
<script type="text/javascript" src="inc/js/html2canvas.js"></script>
<script type="text/javascript" src="inc/js/common.js"></script>

<script>
    
$(document).ready(function() {

    uParams = getParams();
    var dataDir = 'RESULT/data_koreaen/' + uParams.date + '/' + uParams.time
    on_map(dataDir,3065,2164);
    makeChart();

});
    


function makeChart() {
    // 차트 생성
    var ctx = document.getElementById("radarChart").getContext('2d');

    
   
    var rectangle = new Path2D();
    rectangle.rect(10, 10, 50, 50);

    var circle = new Path2D();
    circle.moveTo(125, 35);
    circle.arc(100, 35, 25, 0, 2 * Math.PI);

    ctx.stroke(rectangle);
    ctx.fill(circle);
   
    var chartOptions = {
        scale: {
            display: true,
            pointLabels: {
                fontSize: 24,
                fontStyle: "bold"
            },
            gridLines: {
                circular: true,
                color:["rgba(0,0,0,0.2)","rgba(0,0,0,0.2)","rgba(0,0,0,0.2)","#538dbe","rgba(0,0,0,0.2)","rgba(0,0,0,0.2)","rgba(0,0,0,0.2)","#82c892"],
                lineWidth:[1,1,1,1,1,1,1,3],
                backgroundColor:"rgba(255,255,255,1)"
            },
            ticks: {
                display: true,
                beginAtZero: false,
                min:-300,
                max: 1200,
                stepSize: 200,
                fontSize: 26,
                backdropColor:"rgba(255,255,255,0.2)"
            },
        },
        legend: {
            display: false
        },
        "elements": {
            "line":{
                "tension":0,
                "borderWidth":3
            }
        },
        events: false,
        tooltips: {
            enabled: false
        },
        hover: {
            animationDuration: 0
        },
        animate: false,
    };

    var chartData = {
        "labels":[""],        
        "datasets":[
            {
                "label":"고조",
                "data":[,],
                "fill":"-1",
                "borderColor":"rgb(255, 99, 132)",
                "pointBackgroundColor":"#D92E2E",
                "pointBorderColor":"#fff",
                "pointHoverBackgroundColor":"#fff",
                "pointRadius":6,
                "pointHoverBorderColor":"rgb(255, 99, 132)"
            },
            {
                "label":"고조",
                "data":[,],
                "fill":"-1",
                "backgroundColor":"rgba(255, 99, 132, 0.1)",
                "borderColor":"rgb(255, 99, 132)",
                "pointBackgroundColor":"#D92E2E",
                "pointBorderColor":"#fff",
                "pointHoverBackgroundColor":"#fff",
                "pointRadius":6,
                "pointHoverBorderColor":"rgb(255, 99, 132)"
            },
            {
                "label":"저조",
                "data":[,],
                "fill":"-1",
                "backgroundColor":"rgba(255, 99, 132, 0.1)",
                "borderColor":"rgb(54, 162, 235)",
                "pointBackgroundColor":"#3B529E",
                "pointBorderColor":"#fff",
                "pointHoverBackgroundColor":"#fff",
                "pointRadius":6,
                "pointHoverBorderColor":"rgb(54, 162, 235)",
                "fontSize":40,
            },            
            {
                "label":"저조",
                "data":[,],
                "fill":"-1",
                "backgroundColor":"rgba(54, 162, 235, 0.2)",
                "borderColor":"rgb(54, 162, 235)",
                "pointBackgroundColor":"#3B529E",
                "pointBorderColor":"#fff",
                "pointHoverBackgroundColor":"#fff",
                "pointRadius":6,
                "pointHoverBorderColor":"rgb(54, 162, 235)",
                "fontSize":40,
            },
            {
                "label":"",
                "data":[,0,0,0,0,0,0,0,0,0,0,0,0],
                "fill":"-1",
                "backgroundColor":"rgba(54, 162, 235, 0.2)",
                "borderColor":"rgba(0,0,0,0)",
                "pointBackgroundColor":"rgb(255,255,255)",
                "pointBorderColor":"rgba(0,0,0,0)",
                "pointHoverBackgroundColor":"rgba(0,0,0,0)",
                "pointHoverBorderColor":"rgba(0,0,0,0)"
            }
        ]
    };
    
    var tideTimeDegrees = [28,55,83,111,138,166,194,222,249,277,305,332];

    uParams = getParams();
    var dataDir = 'RESULT/data_koreaen/' + uParams.date + '/' + uParams.time
    
    $.ajax({
		type: "GET",
		url: dataDir + "/chart_radar.json",
		dataType: "json",
		contentType:"application/x-www-form-urlencoded; charset=UTF-8",
		success: function(data){
			
			var cnt = data.CHART.length;
			for(var i=0; i < cnt; i++){                
                // radar chart data
                chartData.labels.push(data.CHART[i].POS_NAME);
                chartData.datasets[0].data.push(parseFloat(data.CHART[i].TIDE_HIGH_VALUE_01));
                chartData.datasets[1].data.push(parseFloat(data.CHART[i].TIDE_HIGH_VALUE_02));
                chartData.datasets[2].data.push(parseFloat(data.CHART[i].TIDE_LOW_VALUE_01));
                chartData.datasets[3].data.push(parseFloat(data.CHART[i].TIDE_LOW_VALUE_02));
                
                // tide time
                $(".tideTime:eq("+i+")").find(".tide_low:eq(0)").text(data.CHART[i].TIDE_LOW_TIME_01);
                $(".tideTime:eq("+i+")").find(".tide_high:eq(0)").text(data.CHART[i].TIDE_HIGH_TIME_01);
                $(".tideTime:eq("+i+")").find(".tide_low:eq(1)").text(data.CHART[i].TIDE_LOW_TIME_02);
                $(".tideTime:eq("+i+")").find(".tide_high:eq(1)").text(data.CHART[i].TIDE_HIGH_TIME_02);
                $(".tideTime:eq("+i+")").rotate(tideTimeDegrees[i]);            
			}
            
            console.log(chartData.datasets);
            // make radar chart
            new Chart(document.getElementById("radarChart"),{
                "type":"radar",
                "data":chartData,
                "options":chartOptions
            });
            
            // moon image change
            $(".moon").html('<img src="inc/img/moon/moon_'+data.CHART_LEGEND.MOON_STEP+'.png" />');
			
            // chart legend update
            $(".sunTime_01").text(data.CHART_LEGEND.SUN_TIME_01);
            $(".sunTime_02").text(data.CHART_LEGEND.SUN_TIME_02);
            $(".sunTime_03").text(data.CHART_LEGEND.SUN_TIME_03);
            $(".moonTime_01").text(data.CHART_LEGEND.MOON_TIME_01);
            $(".moonTime_02").text(data.CHART_LEGEND.MOON_TIME_02);
            $(".moonTime_03").text(data.CHART_LEGEND.MOON_TIME_03);
            
			
		},error: function(XMLHttpRequest, textStatus, errorThrown) { 
			console.log("Status: " + textStatus+":"+errorThrown);
		}
	});		
}
    
Chart.pluginService.register({
    beforeRender: function(chart) {    
    },
    beforeDraw: function(chart) {
      var context = chart.ctx;
      var centerX = chart.scale.xCenter;
      var centerY = chart.scale.yCenter;
      var radius = 305;

      context.beginPath();
      context.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);
      context.fillStyle = 'rgba(255,255,255,0.8)';
      context.fill();
    },
    afterDraw: function(chart, easing) {
      
    }
});

    
</script>
    
</head>

<body class='koreaen'> 
<div class="dailyOcean">

	<div class="headerContainer" >
		<div id="image_down"  class="topLogo f_L" onClick="pageDownload();" style="cursor:pointer;">
            <img src="inc/img/logo_mofKhoa_eng.jpg" class="f_L" height="105"/> <!-- width="383" height="105" /> -->
            <h1>Marine Forecast Chart</h1>
        </div>
		<div class="today f_R">
            <span class="arrow"><i class="icon-arrow"></i></span>
            <span class="date"></span>
            <span class="time"></span>
            <span class="lunar_date"></span>
        </div>
	</div>
	
	
	
	<div class="contentsContainer">
		
		<div class="mapContainer">
			
            <div class="onMap"></div>
			
            <div class="oceanName eastSea"><img src="inc/img/txt_Img_Eastsea_eng.png" /></div>
            <div class="oceanName yellowSea"><img src="inc/img/txt_Img_Yellowsea_eng.png" /></div>
            <div class="oceanName dokdo"><img src="inc/img/txt_Img_Dokdo_eng.png" /></div>
            <div class="oceanName ongjin"><img src="inc/img/txt_Img_Ongjin_eng.png" /></div>
            <div class="oceanName shinan"><img src="inc/img/txt_Img_Shinan_eng.png" /></div>
            <div class="oceanName ieodo"><img src="inc/img/txt_Img_Ieodo_eng.png" /></div>

            <div style="position:absolute; top: 430px; left:1145px;"><img src="inc/img/loc/txten_seoul.png"/>        </div>
            <div style="position:absolute; top: 750px; left:1240px;"><img src="inc/img/loc/txten_sejong.png"/>       </div>
            <div style="position:absolute; top: 800px; left:1275px;"><img src="inc/img/loc/txten_daejeon.png"/>      </div>
            <div style="position:absolute; top: 945px; left:1630px;"><img src="inc/img/loc/txten_daegu.png"/>        </div>
            <div style="position:absolute; top:1175px; left:1080px;"><img src="inc/img/loc/txten_gwangju.png"/>      </div>
            <div style="position:absolute; top: 510px; left:1220px;"><img src="inc/img/loc/txten_gyeonggido.png"/>   </div>
            <div style="position:absolute; top: 400px; left:1520px;"><img src="inc/img/loc/txten_gangwondo.png"/>    </div>
            <div style="position:absolute; top: 610px; left:1350px;"><img src="inc/img/loc/txten_chungcheongN.png"/> </div>
            <div style="position:absolute; top: 660px; left:1080px;"><img src="inc/img/loc/txten_chungcheongS.png"/> </div>
            <div style="position:absolute; top: 750px; left:1630px;"><img src="inc/img/loc/txten_gyeongsangN.png"/>  </div>
            <div style="position:absolute; top:1070px; left:1460px;"><img src="inc/img/loc/txten_gyeongsangS.png"/>  </div>
            <div style="position:absolute; top: 980px; left:1200px;"><img src="inc/img/loc/txten_jeonlaN.png"/>      </div>
            <div style="position:absolute; top:1240px; left:1130px;"><img src="inc/img/loc/txten_jeonlaS.png"/>      </div>
            
            <div class="chartWrap">
                
                <canvas id="radarChart" width="760" height="780"></canvas>
                <div class="tideUnit">(cm)</div>
                <div class="moon"><img src="inc/img/moon/moon_01.png" /></div>
                <div class="tideTime t_01">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_02">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_03">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_04">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_05">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_06">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_07">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_08">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_09">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_10">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_11">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>
                <div class="tideTime t_12">
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span><br />
                    <span class="tide_high">00:00</span>
                    <span class="tide_low">00:00</span>
                </div>                
            </div>
            
            <div class="chartLegend">
                <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <th rowspan="2">Incheon</th>
                        <td><img src="inc/img/icon_sunrise.png" /></td>
                        <td>Sunrise</td>
                        <td class="sunTime_01">00:00</td>
                        <td><img src="inc/img/icon_sun_culmination.png" /></td>
                        <td>SolarTransit</td>
                        <td class="sunTime_02">00:00</td>
                        <td><img src="inc/img/icon_sunset.png" /></td>
                        <td>Sunset</td>
                        <td class="sunTime_03">00:00</td>
                    </tr>
                    <tr>
                        <td><img src="inc/img/icon_moonrise.png" /></td>
                        <td>Moonrise</td>
                        <td class="moonTime_01">00:00</td>
                        <td><img src="inc/img/icon_moon_culmination.png" /></td>
                        <td>LunarTransit</td>
                        <td class="moonTime_02">00:00</td>
                        <td><img src="inc/img/icon_moonset.png" /></td>
                        <td>Moonset</td>
                        <td class="moonTime_03">00:00</td>
                    </tr>                        
                </table>
            </div>
            
		</div>
		
	</div>

    <div class="legendContainer">
        <!-- legend -->
        <div class="legend">
          <div class="lgdBox current">
            <ul>
              <li>Surface<br>Currents<br>(cm/s)</li>
              <li style="width:  40px;"><img src="inc/img/SCAROW01.svg" style="transform: scale(0.75) rotate(90deg);"/><br>50</li>
              <li style="width:  70px;"><img src="inc/img/SCAROW01.svg" style="transform: scale(1.50) rotate(90deg);"/><br>100</li>
              <li style="width: 120px;"><img src="inc/img/SCAROW01.svg" style="transform: scale(2.25) rotate(90deg);"/><br>150</li>
            </ul>
          </div>
          <div class="lgdBox tideForecast">
            <div class="bullet"><svg height="80" width="20">
                <circle cx="10" cy="40" r="10" stroke="black" stroke-width="0" fill="#F9A01E" /></svg></div>
            <ul>
              <li class="accentBg">TidalCurrents</li>
              <li class="t_C tBlue">Slack Time</li>
              <li class="t_C" style="background-color: #F9A01E; color: #fff;">Max Time</li>
              <li class="t_C">Max cm/s</li>
            </ul>
          </div>
          <div class="lgdBox flooding">
            <div class="bullet"><img src="inc/img/icon_floodingArea.png" /></div>
            <ul>
              <li>CoastalFlooding</li>
              <li class="accentBg">CautionTime</li>
            </ul>
          </div>
          <div class="lgdBox wTemp_wHeight">
            <ul>
              <li><img src="inc/img/icon_waterTemp.png" />SST</li>
              <li><img src="inc/img/icon_waveHeight.png" />Wave</li>
              <li><img src="inc/img/icon_wind.png" />Wind</li>
            </ul>
          </div>
          <div class="lgdBox wTempColorBar">
            <ul>
              <li><br>SST<br>(°C)</li>
              <li>
                <ul class="colorBar">
                  <li>0</li>
                  <li>5</li>
                  <li>10</li>
                  <li>15</li>
                  <li>20</li>
                  <li>25</li>
                  <li>30</li>
                  <li>35</li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="lgdBox tideCircle">
            <ul>
              <li><img src="inc/img/icon_tideLegend.png" /></li>
              <li>
                <svg height="20" width="20">
                  <circle cx="10" cy="10" r="10" stroke="black" stroke-width="0" fill="#d92e2e" /></svg> HighTide<span class="text tideHigh">HighTideTime</span><br />
                <svg height="20" width="20">
                  <circle cx="10" cy="10" r="10" stroke="black" stroke-width="0" fill="#3b529e" /></svg> &nbsp;LowTide<span class="text tideLow"> LowTideTime</span>
              </li>
            </ul>
          </div>
        </div>
    </div>
    
</div>

</body>
<script>
    $(function () {
        setTimeout("pageDownload()", 1000);
    });
</script>
</html>
